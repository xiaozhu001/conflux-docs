# 敏感发布协议

由于新引入的变化可能非常剧烈以至于难以考虑所有潜在的副作用，因此在这里介绍了推出这类敏感变化的协议，其方式为：

- 最大限度减少对终端用户的不利影响。
- 最大限度提高我们对这些变化的响应能力。

## 协议步骤

1. 准备正常发布版本。
2. 准备一个用于回滚的版本。
3. 释放正常发布版本。
4. 在紧急情况下，进行回滚。

### 正常发布

只要按照 [发布指南](./publishing-cn.md)中的步骤操作即可。

### 准备回滚版本

在不同的上下文环境下按照 [发布指南](./publishing-cn.md)中的步骤操作。 

相比于在主分支上创建一个版本分支，不如直接在最新版本上创建一个版本分支。按照惯例，该版本会递增补丁的版本号。

### 释放正常发布版本

确保回滚版本已经构建并下载到本地，为紧急的部署做好了完全的准备。

对于较为敏感的版本，最开始只向1%的Chrome用户推送（Chrome允许增量释放）。

监控错误主动系统系统Sentry是否有任何可是别的错误日志。

逐步提高推送比例。

### 在紧急情况下

如果发现问题，要将回滚版本发布给所有用户，对现有问题进行识别与修复，随后在新版释放中重复该步骤。

## 摘要

该协议针对的是最糟糕的情况，是一种对敏感变化格外谨慎的方法。
